@page "/chitietsanpham/{id}"
@inject R4CloThes.Client.Helpers.IAPIHelper _apihelper
@inject ILocalStorageService localStorage
@inject ISnackbar _snackbar
@inject ICartService _cartService
@inject NavigationManager nav

@if (isLoading)
{
    <p>Loading ...</p>
}
else
{
    <style>
        .img-detail {
            width: 100%;
            height: 450px;
        }

        .tensp {
            font-size: 24px;
            font-weight: 700;
            margin: 10px 0 40px 0;
        }

        .gia {
            font-size: 18px;
            color: red;
            margin-top: 10px;
            margin-bottom: 20px;
        }
    </style>

    <div class="m-auto border border-2">
        <div class="row">
            <div class="col-4">
                <img class="img-detail" src="https://res.cloudinary.com/r4clothes/image/upload/@sanPham.Hinh" />
            </div>
            <div class="col-8 p-4 border border-1">
                <div class="tensp">@sanPham.Tensanpham</div>
                @if (sanPham.Giamgia > 0)
                {
                    <div class="phanloai"><del>Giá : @string.Format("{0:#,##0.00}", sanPham.Gia)</del></div>
                    <div class="gia">Giảm giá : @sanPham.Giamgia%</div>
                    <div class="gia">Giá khuyến mãi : @string.Format("{0:#,##0.00}", SauGiamGia)</div>
                }
                else
                {
                    <div class="gia">Giá : @string.Format("{0:#,##0.00}", sanPham.Gia)</div>
                }
            <div class="control">
                <MudCardActions>
                    <MudIconButton Icon=@icon Color="Color.Error" />
                    <MudIconButton OnClick="OpenDialog" Icon="@Icons.Material.Filled.Share" Color="Color.Default" />
                </MudCardActions>
                <MudGrid>
                    <MudItem xs="12" sm="6" md="4">
                        <MudTextField @bind-Value="soLuongMua" Label="Số lượng" Variant="Variant.Outlined"></MudTextField>
                    </MudItem>
                </MudGrid>
                <MudButton Variant="Variant.Outlined" Color="Color.Info" OnClick="AddToCart">Thêm vào giỏ hàng</MudButton>
            </div>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="p-3">
                    <h4>MÔ TẢ SẢN PHẨM</h4>
                    <p>@sanPham.Mota</p>
                </div>
            </div>
        </div>
        <div class="row">
            <MudGrid>
                <MudItem xs="12">
                    <MudGrid Justify="Justify.Center">
                        <MudItem>
                            <MudPaper Style="height:500px;width:1000px;">
                                <hr />
                                <MudGrid>
                                    <MudItem sm="1">
                                        <MudAvatar Image="@imgKhachhang" Style="height:45px; width:45px;" Class="ma-2" />
                                    </MudItem>
                                    <MudItem sm="9" md="6">
                                        <MudTextField @bind-Value="dgsp.Noidung" Label="Bình luận" Variant="Variant.Outlined"></MudTextField>
                                    </MudItem>
                                    <MudItem sm="2" md="4">
                                        <MudButton Variant="Variant.Filled" EndIcon="@Icons.Material.Filled.Send">Gửi</MudButton>
                                    </MudItem>
                                </MudGrid>
                                <hr />
                                @foreach (var item in dsdanhgia)
                                {
                                    <MudGrid>
                                        <MudItem xs="1">
                                            <MudContainer Class="ml-auto mt-3">
                                                <img src="https://res.cloudinary.com/r4clothes/image/upload/@item.Hinh" width="100px" height="100px" alt="ava" />
                                            </MudContainer>
                                        </MudItem>
                                        <MudItem xs="11">
                                            <div class="mt-3 ml-0 d-flex">
                                                <div>
                                                    <MudText>@item.Tenkhachhang</MudText>
                                                    <MudText>@item.NoiDung</MudText>
                                                </div>
                                            </div>
                                        </MudItem>
                                    </MudGrid>
                                }
                            </MudPaper>
                        </MudItem>
                    </MudGrid>
                </MudItem>
            </MudGrid>
        </div>
    </div>
}